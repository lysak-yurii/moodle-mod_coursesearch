define(["jquery"],function($){"use strict";function scrollToText(element,searchText){if(!element||!searchText){return false}const walker=document.createTreeWalker(element,NodeFilter.SHOW_TEXT,null,false);let node;const textNodes=[];while(node=walker.nextNode()){textNodes.push(node)}const searchLower=searchText.toLowerCase();for(let i=0;i<textNodes.length;i++){const text=textNodes[i].textContent.toLowerCase();const index=text.indexOf(searchLower);if(index!==-1){const range=document.createRange();const textNode=textNodes[i];const originalText=textNode.textContent;const originalIndex=originalText.toLowerCase().indexOf(searchLower);if(originalIndex!==-1){try{range.setStart(textNode,originalIndex);range.setEnd(textNode,originalIndex+searchText.length);const rect=range.getBoundingClientRect();const scrollY=window.scrollY+rect.top-100;window.scrollTo({top:scrollY,behavior:"smooth"});const span=document.createElement("span");span.style.backgroundColor="#ffff99";span.style.padding="2px";span.style.borderRadius="2px";span.className="coursesearch-highlight-temp";try{range.surroundContents(span);setTimeout(function(){if(span.parentNode){const parent=span.parentNode;parent.replaceChild(document.createTextNode(span.textContent),span);parent.normalize()}},3e3)}catch(e){const parent=textNode.parentElement;if(parent&&parent!==element&&parent.tagName!=="BODY"&&parent.tagName!=="HTML"){const originalBg=parent.style.backgroundColor;const originalTransition=parent.style.transition;parent.style.backgroundColor="#ffff99";parent.style.transition="background-color 0.3s";setTimeout(function(){parent.style.backgroundColor=originalBg;setTimeout(function(){parent.style.transition=originalTransition},300)},3e3)}}return true}catch(e){const elementTop=element.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:elementTop-100,behavior:"smooth"});return true}}}}return false}function init(){const urlParams=new URLSearchParams(window.location.search);let highlightText=urlParams.get("highlight");if(!highlightText&&typeof sessionStorage!=="undefined"){highlightText=sessionStorage.getItem("coursesearch_highlight");if(highlightText){sessionStorage.removeItem("coursesearch_highlight")}}if(!highlightText){return}const searchText=decodeURIComponent(highlightText).trim();if(!searchText){return}$(document).ready(function(){setTimeout(function(){const hash=window.location.hash;if(hash){const match=hash.match(/^#module-(\d+)$/);if(match){const moduleId=match[1];const moduleElement=document.getElementById("module-"+moduleId);if(moduleElement){if(!scrollToText(moduleElement,searchText)){const elementTop=moduleElement.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:elementTop-100,behavior:"smooth"})}}}else{scrollToText(document.body,searchText)}}else{scrollToText(document.body,searchText)}},500)})}function autoInit(){if(window.location.pathname.indexOf("/course/view.php")===-1){return}const urlParams=new URLSearchParams(window.location.search);let highlightText=urlParams.get("highlight");if(!highlightText&&typeof sessionStorage!=="undefined"){highlightText=sessionStorage.getItem("coursesearch_highlight")}if(highlightText){init()}}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",function(){setTimeout(autoInit,500)})}else{setTimeout(autoInit,500)}return{init:init}});
//# sourceMappingURL=scrolltohighlight.min.js.map